---
startDelaySeconds: 0
hostPort: spark-streaming:9999
ssl: false
lowercaseOutputName: false
lowercaseOutputLabelNames: false
rules:
  # Spark Application metrics
  - pattern: 'org.apache.spark<type=(\w+), name=(\w+)><>Value'
    name: spark_application_$1_$2
    type: GAUGE
  - pattern: 'org.apache.spark<type=(\w+), name=(\w+)><>Count'
    name: spark_application_$1_$2_count
    type: COUNTER
  # Spark Streaming metrics
  - pattern: 'org.apache.spark<type=streaming, name=(\w+)><>Value'
    name: spark_streaming_$1
    type: GAUGE
  - pattern: 'org.apache.spark<type=streaming, name=(\w+)><>Count'
    name: spark_streaming_$1_count
    type: COUNTER
  # JVM metrics
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><used>'
    name: jvm_memory_heap_used_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><max>'
    name: jvm_memory_heap_max_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><committed>'
    name: jvm_memory_heap_committed_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><NonHeapMemoryUsage><used>'
    name: jvm_memory_nonheap_used_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><NonHeapMemoryUsage><max>'
    name: jvm_memory_nonheap_max_bytes
    type: GAUGE
  - pattern: 'java.lang<type=GarbageCollector, name=(\w+)><>CollectionCount'
    name: jvm_gc_collections_total
    type: COUNTER
    labels:
      gc: $1
  - pattern: 'java.lang<type=GarbageCollector, name=(\w+)><>CollectionTime'
    name: jvm_gc_collection_seconds_total
    type: COUNTER
    labels:
      gc: $1
  - pattern: 'java.lang<type=Threading><>ThreadCount'
    name: jvm_threads_current
    type: GAUGE
  - pattern: 'java.lang<type=Threading><>PeakThreadCount'
    name: jvm_threads_peak
    type: GAUGE
  - pattern: 'java.lang<type=Runtime><>Uptime'
    name: jvm_uptime_seconds
    type: GAUGE

