---
startDelaySeconds: 0
hostPort: spark-worker-1:7079
ssl: false
lowercaseOutputName: false
lowercaseOutputLabelNames: false
rules:
  # Spark Worker metrics
  - pattern: 'org.apache.spark<type=worker, name=(\w+)><>Value'
    name: spark_worker_$1
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker, name=(\w+)><>Count'
    name: spark_worker_$1_count
    type: COUNTER
  - pattern: 'org.apache.spark<type=worker><>CoresFree'
    name: spark_worker_cores_free
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker><>CoresUsed'
    name: spark_worker_cores_used
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker><>MemoryFree'
    name: spark_worker_memory_free_bytes
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker><>MemoryUsed'
    name: spark_worker_memory_used_bytes
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker><>Executors'
    name: spark_worker_executors
    type: GAUGE
  - pattern: 'org.apache.spark<type=worker><>Apps'
    name: spark_worker_apps
    type: GAUGE
  # JVM metrics
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><used>'
    name: jvm_memory_heap_used_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><max>'
    name: jvm_memory_heap_max_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><HeapMemoryUsage><committed>'
    name: jvm_memory_heap_committed_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><NonHeapMemoryUsage><used>'
    name: jvm_memory_nonheap_used_bytes
    type: GAUGE
  - pattern: 'java.lang<type=Memory><NonHeapMemoryUsage><max>'
    name: jvm_memory_nonheap_max_bytes
    type: GAUGE
  - pattern: 'java.lang<type=GarbageCollector, name=(\w+)><>CollectionCount'
    name: jvm_gc_collections_total
    type: COUNTER
    labels:
      gc: $1
  - pattern: 'java.lang<type=GarbageCollector, name=(\w+)><>CollectionTime'
    name: jvm_gc_collection_seconds_total
    type: COUNTER
    labels:
      gc: $1
  - pattern: 'java.lang<type=Threading><>ThreadCount'
    name: jvm_threads_current
    type: GAUGE
  - pattern: 'java.lang<type=Threading><>PeakThreadCount'
    name: jvm_threads_peak
    type: GAUGE
  - pattern: 'java.lang<type=Runtime><>Uptime'
    name: jvm_uptime_seconds
    type: GAUGE

